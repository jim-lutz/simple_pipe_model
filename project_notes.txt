2018-03-30
    see http://happygitwithr.com/ to set up git repository
    follow her directions in the directory above, not here.
    
    in a trial read_pipe_data.R reads stuff in from a spreadsheet.
    will have to set range, 
    hopefully that won't have to be manually set different for each spreadsheet
    
2018-04-02
    manually collect metadata on pipe testing spreadsheets.
    
    instead try getting tidyxl to read specific information from Sheet1 in each of the 
    spreadsheets https://nacnudus.github.io/tidyxl/
    
    test on title
    
    went back to readxl
    was able to read meta data from all the spreadsheets
    don't have TC locations correct yet
    
2018-04-04
   
   use the index of the file loop to test for CPVC
   first 4 fields look OK. Not sure what was being read for rest.
   
   found pluck() to pick elements out of a tibble.
   
   able to read all test info from spreadsheet headers.
   34RigidCuBareRawData1.xlsx
   34RigidCUR47RawData1.xlsx
   Copy of 34RigidCUR47RawData1.xlsx
   all have the same title 
        3/4 RIGID CU RAW TEST DATA - ALL 1 SECOND DATA ?
    
   Seems to read data from 12PEXBareRawData2.xlsx
   still need to get the notes field 
   When set rows too high to catch all for spreadsheets it choked
   problems with dates because NOMINAL is in that column
   
2018-04-05

    manually collect data and note ranges
    see pipe_data_ranges.csv
    
    in 12PEXBareRawData2.xlsx 10 temperatures for TC1 are 'NAN' 
    Coercing text to numeric in E58130 / R58130C5: 'NAN'
    
    maybe at this stage get each Sheet1 into it's own data.table
    then incremental cleanups.
    
    34CPVCBareRawData2.xlsx too big?
    use unbounded rectangles. read notes and data together. trim later
    
    Cu files have more columns of data        

    fix later
    =========
    timestamp is in Excel date format

2018-04-09
    nominal & test flag as separate columns?
    
    processed timestamp for NOMINAL and other glitches
    
    work on testflag next
    
2018-04-10
   
    spreadsheet timestamps and DT_data.3[,timestamp] don't line up!
    DT_data.3[, list(start = min(timestamp),end   = max(timestamp))]
                 start                 end
    1: 2009-11-15 02:51:13 2009-12-08 06:31:31

    2009-11-13 02:51:13
    2009-12-06 06:31:32     
    
    revise clean_data.1.R to pull start and end timestamps into DT_test_info, both .csv & .Rdata
    
    Excel time! origin="1899-12-30"
    time zones! tz = "UTC" then force_tz  tzone = "America/Los_Angeles"
        
    not quite, origin in as.POSIXct has to be as.POSIXct as well 
    as.POSIXct(timestamp.num * 24*60*60,
            origin=as.POSIXct("1899-12-30", tz="America/Los_Angeles"),
            tz = "America/Los_Angeles")
    
2018-04-13
    in 12PEXBareRawData2 at least 5 rows after TestFlag=="START" and 
    5 rows before TestFlag=="END" are comments on test type.
    one TestFlag=="END" is missing.
    
    script to collect test segment information for all data sets to see what 
    needs to be fixed by hand.
    
2018-04-16
    figure out some way to collect comments
    near START & END
    look at other comments?
    number tests?
    
    1899-12-30 21:14:17 timestamp in 34RigidCuBareRawData1.xlsx?

    finding and fixing anamolous data in ./data/3/*.Rdata 
    
    fix anomalous data using separate program for each bfname 
    source after loading DT_data.3
    
    identify records that are part of a test
    
    DT_tests {START, END, comment) save /4/{bfname}_test.Rdata
    DT_data { ..., comment (across test records only), other.comment }
    
2018-04-18
    starting to build 12PEXBareRawData2.findNfixTF.R to find and fix anomalies in 
    12PEXBareRawData2
    
2018-04-19
    rename to findNfixTF.12PEXBareRawData2.R
    
    TestFlag contains
    START 1/2 PEX BARE IN-AIR WARM TEST 7
        START|END
        nom pipe diam
        pipe matl
        insulation level
        IN-AIR
        COLD|WARM
        TEST #, some are repeated
    
    Parse into
        test.edge
        nom.pipe.diam
        pipe.matl
        insul.level
        ?
        test.num <- only between appropriate START and END 

    These are in the filename, just confirm they match?        
        nom.pipe.diam
        pipe.matl
        insul.level
        
    Only doing IN-AIR, check consistency but not deal with it    
            
    COLD|WARM don't match test.type derived from nominal?
    figure out what's going on here

2018-04-20
    figure out a generic way to parse TestFlag into 
    test.edge, nom.pipe.diam, pipe.matl, insul.level, cold.warm, test.num
    
    don't forget to check '.' to 'COOL DOWN'
    
    test.edge only single record
    nom.pipe.diam, pipe.matl, insul.level are for entire spreadsheet
    cold.warm is for ?, starting conditions? chart this to see
    test.num between edge==START and edge==END inclusive
    
    still have to deal with other.comments
    
2018-04-23
    cold.warm is for starting condition. varies by test.num and test.segment, add to test.segment
    outside of test.segments, there's sometimes a MAKE TEMPS UNIFORM and a COOL DOWN
    those are probably to calculate UA and thermal mass 
    UA calculated from last few records before a COOL DOWN, or maybe the last few records of a test
    check papers.
    thermal mass calculated from COOL DOWN. flow turned off at COOL DOWN.
    maybe make some cooldown.segments as well?
    
    probably should make a charting function to see what's going on graphically
    
    need to clean up findNfixTF.12PEXBareRawData2.R as well.
    
2018-04-24
    check test.type in DT_data.3, may not match data
    
    can get rid of edge
        
2018-04-25
    after finding anomalies in findNfixTF, put the fix before the test
    that way it'll pass the test when rerun.        